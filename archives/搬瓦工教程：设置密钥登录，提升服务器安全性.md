# 搬瓦工教程：设置密钥登录，提升服务器安全性

许多用户购买VPS并设置节点后，往往忽视了服务器的安全性。然而，搬瓦工默认的SSH端口为22，且以密码登录为默认方式，这无形中为不怀好意的人提供了机会。他们可能通过密码爆破获取你的服务器控制权，用于非法挖矿等操作，最终导致服务器受到不良影响。因此，购买VPS后，第一步就是正确配置密钥，并将服务器设置为仅允许密钥登录。以下是详细教程。

👉 [【建议收藏】2025年搬瓦工最新优惠套餐整理汇总 - 每日更新最新可用优惠码](https://bit.ly/banwagon)

---

## 一、本地生成密钥文件和文本

### 1. 下载并运行 PuTTYgen 密钥生成工具

在 Windows 系统中，您可以下载 [PuTTYgen](https://the.earth.li/~sgtatham/putty/latest/w64/puttygen.exe) 密钥生成工具。打开软件后：

- 选择 **RSA** 类型密钥。
- 设置 **密钥长度** 为 **4096**。
- 点击 **Generate** 按钮开始生成密钥。在生成过程中，需要在窗口空白处移动鼠标来推进进度条完成。

### 2. 导出密钥文件

生成密钥对后，请依次操作：

- 点击顶部菜单的 **Conversions → Export OpenSSH key**。
- 保存密钥文件，文件后缀必须为 `.pem`。

### 3. 备份公钥文本

复制软件中生成的公钥文本内容（软件中对应的输出区域）。稍后将在搬瓦工管理后台使用。

---

## 二、搬瓦工后台上传公钥

### 1. 打开搬瓦工管理面板

登录搬瓦工 KiwiVM 管理页面，进入服务器的控制面板。

### 2. 添加公钥

在侧边栏选择 **SSH Keys**，将此前生成的公钥文本粘贴到输入框中，然后点击 **Save SSH Keys** 保存密钥。搬瓦工会在系统重装时自动将该密钥加入到 `/root/.ssh/authorized_keys` 文件。

### 3. 重装系统以激活密钥

在重新安装操作系统时，您会看到弹窗提示 SSH 公钥已自动加入新系统的验证机制中。这标志着密钥配置成功。

---

## 三、关闭密码登录方式

为了进一步提升服务器安全性，建议关闭 SSH 密码登录，仅保留密钥登录方式。

### 1. 修改 SSH 配置文件

通过以下命令编辑服务器的 SSH 设置文件：

bash
nano /etc/ssh/sshd_config

### 2. 禁用密码登录

在打开的配置文件中，找到以下设置项，修改为：

plaintext
PasswordAuthentication no

### 3. 保存修改并退出

- 按 `Ctrl+X` 退出编辑器。
- 按 `Y` 确认保存。

### 4. 重启 SSH 服务

最后，通过如下命令重启 SSH 服务，应用刚刚的配置修改：

bash
systemctl restart sshd

---

通过以上配置，您的搬瓦工服务器将具有更高的安全性，不仅有效抵御爆破攻击，还能保证服务器资源的合法使用。建议养成定期检查密钥状态和配置的习惯，为您的业务提供更坚实的后盾。